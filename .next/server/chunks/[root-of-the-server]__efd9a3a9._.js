module.exports=[18622,(e,t,r)=>{t.exports=e.x("next/dist/compiled/next-server/app-page-turbo.runtime.prod.js",()=>require("next/dist/compiled/next-server/app-page-turbo.runtime.prod.js"))},56704,(e,t,r)=>{t.exports=e.x("next/dist/server/app-render/work-async-storage.external.js",()=>require("next/dist/server/app-render/work-async-storage.external.js"))},32319,(e,t,r)=>{t.exports=e.x("next/dist/server/app-render/work-unit-async-storage.external.js",()=>require("next/dist/server/app-render/work-unit-async-storage.external.js"))},20635,(e,t,r)=>{t.exports=e.x("next/dist/server/app-render/action-async-storage.external.js",()=>require("next/dist/server/app-render/action-async-storage.external.js"))},24725,(e,t,r)=>{t.exports=e.x("next/dist/server/app-render/after-task-async-storage.external.js",()=>require("next/dist/server/app-render/after-task-async-storage.external.js"))},70406,(e,t,r)=>{t.exports=e.x("next/dist/compiled/@opentelemetry/api",()=>require("next/dist/compiled/@opentelemetry/api"))},93695,(e,t,r)=>{t.exports=e.x("next/dist/shared/lib/no-fallback-error.external.js",()=>require("next/dist/shared/lib/no-fallback-error.external.js"))},54799,(e,t,r)=>{t.exports=e.x("crypto",()=>require("crypto"))},90829,e=>{"use strict";e.s(["PAYTR_STATUS",()=>s,"createPayTRPayment",()=>a,"generatePayTRToken",()=>r,"getPayTRConfig",()=>t,"verifyPayTRCallback",()=>n]);let t=()=>({merchantId:process.env.PAYTR_MERCHANT_ID||"",merchantKey:process.env.PAYTR_MERCHANT_KEY||"",merchantSalt:process.env.PAYTR_MERCHANT_SALT||"",testMode:"true"===process.env.PAYTR_TEST_MODE,baseUrl:process.env.PAYTR_BASE_URL||"https://www.paytr.com"}),r=(t,r)=>{let a=e.r(54799),n=t.merchantId+r.user_ip+r.merchant_oid+r.email+r.payment_amount+t.merchantSalt;return a.createHash("sha256").update(n).digest("hex")},a=async(e,t)=>{try{let r=await fetch(`${e.baseUrl}/odeme/api/get-token`,{method:"POST",headers:{"Content-Type":"application/x-www-form-urlencoded"},body:new URLSearchParams(t)});return await r.json()}catch(e){throw console.error("PayTR payment creation error:",e),Error("PayTR Ã¶deme isteÄŸi oluÅŸturulamadÄ±")}},n=(t,r)=>{let a=e.r(54799),n=r.merchant_oid+t.merchantSalt+r.status+r.total_amount;return a.createHash("sha256").update(n).digest("hex")===r.hash},s={SUCCESS:"success",FAILED:"failed",PENDING:"pending"}},7309,(e,t,r)=>{},25978,e=>{"use strict";e.s(["handler",()=>C,"patchFetch",()=>P,"routeModule",()=>T,"serverHooks",()=>E,"workAsyncStorage",()=>_,"workUnitAsyncStorage",()=>w],25978);var t=e.i(47909),r=e.i(74017),a=e.i(96250),n=e.i(59756),s=e.i(61916),o=e.i(69741),i=e.i(16795),l=e.i(87718),d=e.i(95169),c=e.i(47587),u=e.i(66012),p=e.i(70101),m=e.i(26937),h=e.i(10372),y=e.i(93695);e.i(52474);var R=e.i(220);e.s(["POST",()=>f],50362);var x=e.i(89171),g=e.i(90829);async function f(e){try{console.log("ðŸ’³ Creating PayTR payment token...");let t=await e.json();if(console.log("ðŸ“ Order data for PayTR:",t),!t.orderNumber||!t.customer||!t.total)return console.log("âŒ Validation failed - missing required fields"),x.NextResponse.json({error:"Missing required fields: orderNumber, customer, total",received:t},{status:400});let r=(0,g.getPayTRConfig)();if(!r.merchantId||!r.merchantKey||!r.merchantSalt)return console.log("âŒ PayTR not configured yet"),x.NextResponse.json({error:"PayTR henÃ¼z yapÄ±landÄ±rÄ±lmamÄ±ÅŸ. Evraklar hazÄ±r olduÄŸunda aktif hale getirilecek.",message:"PayTR configuration pending"},{status:503});let a=e.headers.get("x-forwarded-for")||e.headers.get("x-real-ip")||"127.0.0.1",n=t.items.map(e=>`${e.productName}||${e.quantity}||${e.price}||${e.price*e.quantity}`).join("|"),s={merchant_id:r.merchantId,user_ip:a,merchant_oid:t.orderNumber,email:t.customer.email,payment_amount:Math.round(100*t.total),paytr_token:"",user_basket:Buffer.from(n).toString("base64"),debug_on:+!!r.testMode,no_installment:0,max_installment:0,user_name:`${t.customer.firstName} ${t.customer.lastName}`,user_address:`${t.customer.address.street}, ${t.customer.address.district}, ${t.customer.address.city}`,user_phone:t.customer.phone,merchant_ok_url:`${process.env.NEXT_PUBLIC_BASE_URL||"http://localhost:3000"}/payment/success`,merchant_fail_url:`${process.env.NEXT_PUBLIC_BASE_URL||"http://localhost:3000"}/payment/failed`,timeout_limit:30,currency:"TL",test_mode:+!!r.testMode};s.paytr_token=(0,g.generatePayTRToken)(r,s),console.log("âœ… PayTR payment request prepared:",s.merchant_oid);let o=await (0,g.createPayTRPayment)(r,s);if("success"===o.status)return console.log("âœ… PayTR payment token created successfully"),x.NextResponse.json({success:!0,token:o.token,iframeUrl:`https://www.paytr.com/odeme/guvenli/${o.token}`,orderNumber:t.orderNumber,message:"PayTR payment token created successfully",timestamp:new Date().toISOString()});return console.log("âŒ PayTR payment creation failed:",o.reason),x.NextResponse.json({error:"PayTR payment creation failed",reason:o.reason,timestamp:new Date().toISOString()},{status:400})}catch(e){return console.error("âŒ Error creating PayTR payment:",e),x.NextResponse.json({error:"Failed to create PayTR payment",details:e instanceof Error?e.message:"Unknown error",timestamp:new Date().toISOString()},{status:500})}}var v=e.i(50362);let T=new t.AppRouteRouteModule({definition:{kind:r.RouteKind.APP_ROUTE,page:"/api/payments/paytr/route",pathname:"/api/payments/paytr",filename:"route",bundlePath:""},distDir:".next",relativeProjectDir:"",resolvedPagePath:"[project]/src/app/api/payments/paytr/route.ts",nextConfigOutput:"",userland:v}),{workAsyncStorage:_,workUnitAsyncStorage:w,serverHooks:E}=T;function P(){return(0,a.patchFetch)({workAsyncStorage:_,workUnitAsyncStorage:w})}async function C(e,t,a){var x;let g="/api/payments/paytr/route";g=g.replace(/\/index$/,"")||"/";let f=await T.prepare(e,t,{srcPage:g,multiZoneDraftMode:!1});if(!f)return t.statusCode=400,t.end("Bad Request"),null==a.waitUntil||a.waitUntil.call(a,Promise.resolve()),null;let{buildId:v,params:_,nextConfig:w,isDraftMode:E,prerenderManifest:P,routerServerContext:C,isOnDemandRevalidate:A,revalidateOnlyGenerated:N,resolvedPathname:S}=f,k=(0,o.normalizeAppPath)(g),b=!!(P.dynamicRoutes[k]||P.routes[S]);if(b&&!E){let e=!!P.routes[S],t=P.dynamicRoutes[k];if(t&&!1===t.fallback&&!e)throw new y.NoFallbackError}let O=null;!b||T.isDev||E||(O="/index"===(O=S)?"/":O);let U=!0===T.isDev||!b,j=b&&!U,q=e.method||"GET",I=(0,s.getTracer)(),M=I.getActiveScopeSpan(),H={params:_,prerenderManifest:P,renderOpts:{experimental:{cacheComponents:!!w.experimental.cacheComponents,authInterrupts:!!w.experimental.authInterrupts},supportsDynamicResponse:U,incrementalCache:(0,n.getRequestMeta)(e,"incrementalCache"),cacheLifeProfiles:null==(x=w.experimental)?void 0:x.cacheLife,isRevalidate:j,waitUntil:a.waitUntil,onClose:e=>{t.on("close",e)},onAfterTaskError:void 0,onInstrumentationRequestError:(t,r,a)=>T.onRequestError(e,t,a,C)},sharedContext:{buildId:v}},$=new i.NodeNextRequest(e),D=new i.NodeNextResponse(t),L=l.NextRequestAdapter.fromNodeNextRequest($,(0,l.signalFromNodeResponse)(t));try{let o=async r=>T.handle(L,H).finally(()=>{if(!r)return;r.setAttributes({"http.status_code":t.statusCode,"next.rsc":!1});let a=I.getRootSpanAttributes();if(!a)return;if(a.get("next.span_type")!==d.BaseServerSpan.handleRequest)return void console.warn(`Unexpected root span type '${a.get("next.span_type")}'. Please report this Next.js issue https://github.com/vercel/next.js`);let n=a.get("next.route");if(n){let e=`${q} ${n}`;r.setAttributes({"next.route":n,"http.route":n,"next.span_name":e}),r.updateName(e)}else r.updateName(`${q} ${e.url}`)}),i=async s=>{var i,l;let d=async({previousCacheEntry:r})=>{try{if(!(0,n.getRequestMeta)(e,"minimalMode")&&A&&N&&!r)return t.statusCode=404,t.setHeader("x-nextjs-cache","REVALIDATED"),t.end("This page could not be found"),null;let i=await o(s);e.fetchMetrics=H.renderOpts.fetchMetrics;let l=H.renderOpts.pendingWaitUntil;l&&a.waitUntil&&(a.waitUntil(l),l=void 0);let d=H.renderOpts.collectedTags;if(!b)return await (0,u.sendResponse)($,D,i,H.renderOpts.pendingWaitUntil),null;{let e=await i.blob(),t=(0,p.toNodeOutgoingHttpHeaders)(i.headers);d&&(t[h.NEXT_CACHE_TAGS_HEADER]=d),!t["content-type"]&&e.type&&(t["content-type"]=e.type);let r=void 0!==H.renderOpts.collectedRevalidate&&!(H.renderOpts.collectedRevalidate>=h.INFINITE_CACHE)&&H.renderOpts.collectedRevalidate,a=void 0===H.renderOpts.collectedExpire||H.renderOpts.collectedExpire>=h.INFINITE_CACHE?void 0:H.renderOpts.collectedExpire;return{value:{kind:R.CachedRouteKind.APP_ROUTE,status:i.status,body:Buffer.from(await e.arrayBuffer()),headers:t},cacheControl:{revalidate:r,expire:a}}}}catch(t){throw(null==r?void 0:r.isStale)&&await T.onRequestError(e,t,{routerKind:"App Router",routePath:g,routeType:"route",revalidateReason:(0,c.getRevalidateReason)({isRevalidate:j,isOnDemandRevalidate:A})},C),t}},y=await T.handleResponse({req:e,nextConfig:w,cacheKey:O,routeKind:r.RouteKind.APP_ROUTE,isFallback:!1,prerenderManifest:P,isRoutePPREnabled:!1,isOnDemandRevalidate:A,revalidateOnlyGenerated:N,responseGenerator:d,waitUntil:a.waitUntil});if(!b)return null;if((null==y||null==(i=y.value)?void 0:i.kind)!==R.CachedRouteKind.APP_ROUTE)throw Object.defineProperty(Error(`Invariant: app-route received invalid cache entry ${null==y||null==(l=y.value)?void 0:l.kind}`),"__NEXT_ERROR_CODE",{value:"E701",enumerable:!1,configurable:!0});(0,n.getRequestMeta)(e,"minimalMode")||t.setHeader("x-nextjs-cache",A?"REVALIDATED":y.isMiss?"MISS":y.isStale?"STALE":"HIT"),E&&t.setHeader("Cache-Control","private, no-cache, no-store, max-age=0, must-revalidate");let x=(0,p.fromNodeOutgoingHttpHeaders)(y.value.headers);return(0,n.getRequestMeta)(e,"minimalMode")&&b||x.delete(h.NEXT_CACHE_TAGS_HEADER),!y.cacheControl||t.getHeader("Cache-Control")||x.get("Cache-Control")||x.set("Cache-Control",(0,m.getCacheControlHeader)(y.cacheControl)),await (0,u.sendResponse)($,D,new Response(y.value.body,{headers:x,status:y.value.status||200})),null};M?await i(M):await I.withPropagatedContext(e.headers,()=>I.trace(d.BaseServerSpan.handleRequest,{spanName:`${q} ${e.url}`,kind:s.SpanKind.SERVER,attributes:{"http.method":q,"http.target":e.url}},i))}catch(t){if(t instanceof y.NoFallbackError||await T.onRequestError(e,t,{routerKind:"App Router",routePath:k,routeType:"route",revalidateReason:(0,c.getRevalidateReason)({isRevalidate:j,isOnDemandRevalidate:A})}),b)throw t;return await (0,u.sendResponse)($,D,new Response(null,{status:500})),null}}}];

//# sourceMappingURL=%5Broot-of-the-server%5D__efd9a3a9._.js.map